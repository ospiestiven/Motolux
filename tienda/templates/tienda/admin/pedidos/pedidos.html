{% extends 'tienda/admin/layouts/base.html' %}

{% block title %}Gestión de Pedidos{% endblock %}

{% block content %}
{% include 'tienda/admin/includes/sidebar.html' %}

<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center py-4">
    <div>
        <h2 class="h4">Pedidos</h2>
        <p class="mb-0">Gestión de pedidos de clientes.</p>
    </div>
</div>

<div class="card card-body border-0 shadow table-wrapper table-responsive">
    <table class="table table-hover">
        <thead>
            <tr>
                <th class="border-gray-200">ID Pedido</th>
                <th class="border-gray-200">Fecha</th>
                <th class="border-gray-200">Cliente</th>
                <th class="border-gray-200">Email</th>
                <th class="border-gray-200">Total</th>
                <th class="border-gray-200">Estado</th>
                <th class="border-gray-200">Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% for pedido in pedidos %}
            <tr>
                <td>#{{ pedido.id }}</td>
                <td>{{ pedido.fecha|date:"d/m/Y H:i" }}</td>
                <td>{{ pedido.usuario.user.get_full_name|default:pedido.usuario.user.username }}</td>
                <td>{{ pedido.usuario.user.email }}</td>
                <td class="text-success fw-bold">${{ pedido.total|floatformat:2 }}</td>
                <td>
                    <span class="badge 
                        {% if pedido.estado == 'Entregado' %}bg-success
                        {% elif pedido.estado == 'Procesando' %}bg-info
                        {% elif pedido.estado == 'Cancelado' %}bg-danger
                        {% else %}bg-warning{% endif %}">
                        {{ pedido.estado }}
                    </span>
                </td>
                <td>
                    <a href="{% url 'pedido_detalle' pedido.id %}" class="btn btn-primary btn-sm">Ver Detalle</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}